{% extends 'base.html' %}
{% block content %}
<div class="form-container card">
    <h2>{% if form.instance.pk %}Редагувати пацієнта{% else %}Додати пацієнта{% endif %}</h2>
    <form method="post">
        {% csrf_token %}
        
        <!-- Особисті дані -->
        <div class="form-section">
            <h3>Особисті дані</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="{{ form.last_name.id_for_label }}">Прізвище *</label>
                    {{ form.last_name }}
                    {% if form.last_name.errors %}
                        <div class="error">{{ form.last_name.errors.0 }}</div>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.first_name.id_for_label }}">Ім'я *</label>
                    {{ form.first_name }}
                    {% if form.first_name.errors %}
                        <div class="error">{{ form.first_name.errors.0 }}</div>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.middle_name.id_for_label }}">По батькові</label>
                    {{ form.middle_name }}
                </div>
                <div class="form-group">
                    <label for="{{ form.birth_date.id_for_label }}">Дата народження</label>
                    {{ form.birth_date }}
                </div>
                <div class="form-group">
                    <label for="{{ form.gender.id_for_label }}">Стать</label>
                    {{ form.gender }}
                </div>
            </div>
        </div>

        <!-- Медична інформація -->
        <div class="form-section">
            <h3>Медична інформація</h3>
            <div class="form-grid">
                <div class="form-group full-width">
                    <label for="{{ form.diagnosis.id_for_label }}">Діагноз *</label>
                    {{ form.diagnosis }}
                    {% if form.diagnosis.errors %}
                        <div class="error">{{ form.diagnosis.errors.0 }}</div>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label for="{{ form.tnm_staging.id_for_label }}">TNM стадія</label>
                    {{ form.tnm_staging }}
                </div>
                <div class="form-group">
                    <label for="{{ form.disease_stage.id_for_label }}">Стадія захворювання</label>
                    {{ form.disease_stage }}
                </div>
                <div class="form-group">
                    <label for="{{ form.clinical_group.id_for_label }}">Клінічна група</label>
                    {{ form.clinical_group }}
                </div>
                <div class="form-group">
                    <label for="{{ form.treatment_type.id_for_label }}">Тип лікування</label>
                    {{ form.treatment_type }}
                </div>
                <div class="form-group">
                    <label for="{{ form.treatment_goal.id_for_label }}">Мета лікування</label>
                    {{ form.treatment_goal }}
                </div>
            </div>
        </div>

        <!-- Гістологія -->
        <div class="form-section">
            <h3>Гістологічне дослідження</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="{{ form.histology_number.id_for_label }}">Номер гістології</label>
                    {{ form.histology_number }}
                </div>
                <div class="form-group">
                    <label for="{{ form.histology_date.id_for_label }}">Дата гістології</label>
                    {{ form.histology_date }}
                </div>
                <div class="form-group full-width">
                    <label for="{{ form.histology_description.id_for_label }}">Опис гістології</label>
                    {{ form.histology_description }}
                </div>
            </div>
        </div>

        <!-- Лікування -->
        <div class="form-section">
            <h3>Лікування</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="{{ form.ct_simulation_date.id_for_label }}">Дата КТ-симуляції</label>
                    {{ form.ct_simulation_date }}
                </div>
                <div class="form-group">
                    <label for="{{ form.treatment_start_date.id_for_label }}">Дата початку лікування</label>
                    {{ form.treatment_start_date }}
                </div>
                <div class="form-group">
                    <label for="{{ form.total_fractions.id_for_label }}">Кількість фракцій</label>
                    {{ form.total_fractions }}
                </div>
                <div class="form-group">
                    <label for="{{ form.dose_per_fraction.id_for_label }}">Доза на фракцію (Гр)</label>
                    {{ form.dose_per_fraction }}
                </div>
                <div class="form-group">
                    <label for="{{ form.current_fraction.id_for_label }}">Поточна фракція</label>
                    {{ form.current_fraction }}
                </div>
                <div class="form-group">
                    <label for="{{ form.received_dose.id_for_label }}">Отримана доза (Гр)</label>
                    {{ form.received_dose }}
                </div>
                <div class="form-group">
                    <label for="{{ form.missed_days.id_for_label }}">Пропущені дні</label>
                    {{ form.missed_days }}
                </div>
                <div class="form-group">
                    <label for="{{ form.discharge_date.id_for_label }}">Дата виписки</label>
                    {{ form.discharge_date }}
                </div>
            </div>
        </div>

        <!-- Додаткова інформація -->
        <div class="form-section">
            <h3>Додаткова інформація</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="{{ form.current_stage.id_for_label }}">Поточний етап</label>
                    {{ form.current_stage }}
                </div>
                <div class="form-group">
                    <label for="{{ form.treatment_phase.id_for_label }}">Фаза лікування</label>
                    {{ form.treatment_phase }}
                </div>
                <div class="form-group">
                    <label for="{{ form.irradiation_zone.id_for_label }}">Зона опромінення</label>
                    {{ form.irradiation_zone }}
                </div>
                <div class="form-group">
                    <label for="{{ form.inpatient_status.id_for_label }}">Статус госпіталізації</label>
                    {{ form.inpatient_status }}
                </div>
                <div class="form-group">
                    <label for="{{ form.ward_number.id_for_label }}">Номер палати</label>
                    {{ form.ward_number }}
                </div>
                <div class="form-group">
                    <label for="{{ form.prior_radiation.id_for_label }}">Попереднє опромінення</label>
                    {{ form.prior_radiation }}
                </div>
                <div class="form-group">
                    <label for="{{ form.last_blood_test_date.id_for_label }}">Дата останнього аналізу крові</label>
                    {{ form.last_blood_test_date }}
                </div>
                <div class="form-group full-width">
                    <label for="{{ form.notes.id_for_label }}">Примітки</label>
                    {{ form.notes }}
                </div>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Зберегти</button>
            <a href="{% url 'patient_list' %}" class="btn btn-secondary">Скасувати</a>
        </div>
    </form>
</div>

<style>
.form-container {
    max-width: 1000px;
    margin: 40px auto;
    padding: 30px;
}
.form-container h2 {
    text-align: center;
    color: var(--primary-color);
    margin-bottom: 30px;
}
.form-section {
    margin-bottom: 30px;
    padding: 20px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: #f8f9fa;
}
.form-section h3 {
    color: var(--primary-color);
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--primary-color);
}
.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}
.form-group {
    display: flex;
    flex-direction: column;
}
.form-group.full-width {
    grid-column: 1 / -1;
}
.form-group label {
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--text-light-color);
}
.form-group input, .form-group select, .form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    font-size: 1rem;
}
.form-group textarea {
    min-height: 100px;
    resize: vertical;
}
.error {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 5px;
}
.form-actions {
    margin-top: 30px;
    text-align: right;
    display: flex;
    justify-content: flex-end;
    gap: 15px;
}
.btn {
    text-decoration: none;
    padding: 10px 20px;
    border-radius: 5px;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 1rem;
}
.btn-primary { background-color: var(--primary-color); }
.btn-secondary { background-color: #6c757d; }
.btn:hover {
    opacity: 0.9;
}
input[type="date"] {
    font-size: 1.15rem;
    padding: 12px 16px;
    border-radius: 8px;
    border: 1.5px solid var(--primary-color);
    background: #fff;
    color: #222;
    min-width: 180px;
    max-width: 100%;
    box-sizing: border-box;
    transition: border-color 0.2s;
}
input[type="date"]:focus {
    border-color: #0056b3;
    outline: none;
    background: #f0f8ff;
}
</style>
{% endblock %} 